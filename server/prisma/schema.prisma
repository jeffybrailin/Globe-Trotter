// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id           String   @id @default(uuid())
  email        String   @unique
  passwordHash String
  name         String
  createdAt    DateTime @default(now())
  
  trips        Trip[]
}

model Trip {
  id          String   @id @default(uuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  title       String
  description String?
  startDate   DateTime
  endDate     DateTime
  coverImage  String?
  isPublic    Boolean  @default(false)
  budget      Decimal? 
  currency    String   @default("USD")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  stops       Stop[]
  expenses    Expense[]
}

model Stop {
  id            String   @id @default(uuid())
  tripId        String
  trip          Trip     @relation(fields: [tripId], references: [id], onDelete: Cascade)
  city          String
  country       String
  arrivalDate   DateTime
  departureDate DateTime
  orderIndex    Int
  
  activities    Activity[]
}

model Activity {
  id          String   @id @default(uuid())
  stopId      String
  stop        Stop     @relation(fields: [stopId], references: [id], onDelete: Cascade)
  name        String
  category    String   // ENUM simulated: SIGHTSEEING, FOOD, ADVENTURE, RELAX, OTHER
  cost        Decimal  @default(0)
  date        DateTime
  status      String   @default("PLANNED") // ENUM: PLANNED, BOOKED, DONE
  notes       String?
}

model Expense {
  id          String   @id @default(uuid())
  tripId      String
  trip        Trip     @relation(fields: [tripId], references: [id], onDelete: Cascade)
  category    String   // TRANSPORT, ACCOMMODATION, MEAL, OTHER
  amount      Decimal
  date        DateTime
  description String?
}
